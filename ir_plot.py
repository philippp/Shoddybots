#!/usr/bin/env python
import csv
import math

OUTFILE_NAME = "roku_remote_%s_%02d.csv"

def TransitionsToTimeseries(transitions, scale):
    timeseries = list()
    time_offset = 0
    for i in range(len(transitions)-1):
        length_on = int(math.floor(transitions[i] / scale))
        length_off = int(math.floor(transitions[i+1] / scale))
        # Go high one tick after the current offset
        timeseries.append((time_offset + 1, 1))
        # We stayed high for the duration of length_on
        timeseries.append((time_offset + length_on, 1)) 
        # ...and went low immediately after
        timeseries.append((time_offset + length_on + 1, 0)) 
        # At the end of this transition phase we're still low
        timeseries.append((time_offset + length_on + length_off, 0))
        time_offset += length_on + length_off
    return timeseries

def WriteCommandTimeseries():
    for scale in [1, 10, 50]:
        for command, transitions in COMMANDS.iteritems():
            with open(OUTFILE_NAME % (command, scale), 'w') as outfile_rawfile:
                outfile = csv.writer(outfile_rawfile)
                timeseries = TransitionsToTimeseries(transitions, scale)
                for pair in timeseries:
                    outfile.writerow(pair)
                
COMMANDS = dict(
    PLAY = [
        882, 436,
        56, 52,
        60, 160,
        56, 164,
        56, 162,
        60, 160,
        58, 162,
        58, 50,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 50,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        58, 162,
        58, 52,
        58, 50,
        60, 50,
        58, 52,
        58, 50,
        60, 50,
        58, 52,
        58, 52,
        58, 164,
        56, 160,
        58, 160,
        60, 160,
        58, 162,
        58, 3500,
        884, 434,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 52,
        58, 164,
        56, 160,
        58, 162,
        58, 160,
        58, 162,
        58, 50,
        60, 162,
        58, 160,
        58, 160,
        60, 160,
        58, 160,
        60, 160,
        60, 50,
        60, 50,
        58, 50,
        58, 52,
        58, 52,
        58, 50,
        58, 52,
        58, 52,
        58, 164,
        56, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 0
        ],
    
    FWD = [
        882, 436,
        60, 50,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 52,
        58, 160,
        60, 160,
        58, 160,
        60, 160,
        58, 162,
        58, 52,
        58, 160,
        58, 162,
        58, 160,
        58, 52,
        58, 52,
        58, 50,
        60, 160,
        58, 52,
        58, 50,
        60, 50,
        60, 50,
        58, 160,
        60, 160,
        58, 162,
        58, 50,
        58, 162,
        58, 160,
        60, 160,
        60, 160,
        58, 3502,
        882, 436,
        58, 50,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 52,
        58, 160,
        58, 162,
        58, 162,
        58, 50,
        58, 52,
        58, 52,
        58, 160,
        60, 50,
        58, 50,
        60, 50,
        60, 50,
        60, 160,
        58, 160,
        60, 160,
        58, 52,
        58, 160,
        60, 160,
        58, 160,
        60, 160,
        58, 0
        ],

    BACK = [
        882, 436,
        56, 54,
        54, 164,
        56, 164,
        56, 162,
        60, 160,
        58, 162,
        58, 52,
        58, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 50,
        58, 162,
        58, 162,
        58, 160,
        58, 52,
        58, 160,
        58, 162,
        58, 52,
        58, 50,
        58, 52,
        58, 52,
        58, 50,
        60, 160,
        58, 52,
        58, 50,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 3500,
        882, 436,
        58, 52,
        58, 162,
        58, 160,
        58, 162,
        58, 160,
        58, 162,
        58, 52,
        58, 162,
        56, 162,
        58, 162,
        58, 160,
        58, 162,
        58, 52,
        56, 162,
        58, 162,
        58, 160,
        60, 50,
        58, 162,
        58, 160,
        58, 52,
        58, 52,
        58, 50,
        58, 52,
        58, 52,
        58, 160,
        60, 50,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 0
        ],

    HOME = [
        882, 436,
        56, 54,
        56, 164,
        56, 162,
        56, 164,
        54, 166,
        54, 164,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 50,
        60, 160,
        58, 162,
        58, 160,
        60, 50,
        58, 52,
        58, 52,
        58, 50,
        60, 50,
        58, 50,
        60, 50,
        60, 50,
        58, 162,
        58, 160,
        58, 162,
        58, 160,
        60, 160,
        60, 160,
        58, 160,
        60, 160,
        58, 3500,
        884, 434,
        60, 50,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 160,
        60, 50,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        58, 52,
        58, 164,
        56, 160,
        58, 162,
        58, 50,
        60, 50,
        58, 52,
        58, 50,
        60, 50,
        60, 50,
        58, 50,
        60, 50,
        58, 164,
        56, 160,
        60, 160,
        60, 160,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 0
        ],
    
    SELECT = [
        882, 436,
        58, 50,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 160,
        60, 50,
        60, 160,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        58, 52,
        58, 162,
        58, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 52,
        58, 50,
        60, 50,
        60, 50,
        58, 52,
        58, 50,
        58, 52,
        58, 50,
        60, 160,
        60, 160,
        58, 160,
        58, 162,
        58, 160,
        60, 160,
        60, 3500,
        882, 436,
        58, 52,
        58, 160,
        60, 160,
        58, 160,
        60, 160,
        60, 160,
        58, 50,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 50,
        60, 160,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        58, 52,
        58, 52,
        58, 50,
        60, 50,
        60, 50,
        58, 50,
        60, 50,
        60, 50,
        58, 160,
        58, 162,
        58, 162,
        58, 160,
        60, 160,
        60, 160,
        58, 3500,
        882, 436,
        60, 50,
        58, 160,
        60, 160,
        60, 160,
        58, 160,
        60, 160,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        58, 162,
        58, 52,
        58, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 50,
        58, 52,
        58, 52,
        58, 50,
        58, 52,
        58, 52,
        58, 50,
        60, 50,
        58, 162,
        58, 160,
        60, 160,
        58, 160,
        60, 2517,
        96, 4256,
        92, 0
        ],

    RIGHT = [
        882, 436,
        60, 50,
        60, 160,
        58, 160,
        60, 160,
        58, 160,
        60, 160,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 50,
        60, 160,
        60, 160,
        58, 160,
        60, 50,
        58, 52,
        58, 160,
        60, 50,
        60, 50,
        58, 50,
        58, 52,
        58, 52,
        58, 162,
        58, 160,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        58, 162,
        58, 3502,
        882, 436,
        58, 50,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 160,
        60, 50,
        58, 162,
        58, 160,
        60, 160,
        58, 160,
        60, 160,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 50,
        60, 50,
        58, 162,
        58, 50,
        60, 50,
        58, 52,
        58, 50,
        60, 50,
        58, 162,
        58, 160,
        60, 50,
        60, 160,
        58, 160,
        58, 162,
        58, 162,
        58, 160,
        60, 3500,
        882, 436,
        58, 52,
        58, 160,
        58, 162,
        58, 160,
        58, 162,
        58, 162,
        58, 50,
        58, 162,
        58, 162,
        58, 160,
        58, 162,
        58, 160,
        58, 52,
        58, 162,
        58, 160,
        60, 160,
        58, 52,
        58, 50,
        60, 160,
        58, 52,
        58, 50,
        58, 52,
        58, 52,
        58, 52,
        58, 160,
        58, 162,
        58, 50,
        60, 160,
        58, 162,
        58, 160,
        60, 3035,
        94, 4768,
        94, 0
        ],
    
    LEFT = [
        882, 434,
        60, 50,
        60, 160,
        58, 160,
        58, 162,
        58, 162,
        58, 160,
        60, 50,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 50,
        60, 160,
        58, 50,
        60, 50,
        60, 50,
        58, 50,
        60, 50,
        60, 50,
        58, 162,
        58, 50,
        58, 162,
        58, 160,
        60, 160,
        60, 160,
        58, 160,
        60, 160,
        58, 3502,
        882, 436,
        58, 50,
        60, 160,
        58, 162,
        58, 160,
        58, 162,
        58, 160,
        60, 50,
        58, 162,
        58, 160,
        58, 162,
        58, 162,
        58, 160,
        58, 52,
        58, 162,
        58, 160,
        58, 162,
        58, 52,
        56, 162,
        58, 52,
        58, 50,
        60, 50,
        58, 52,
        58, 52,
        58, 50,
        60, 160,
        58, 52,
        58, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 0
        ],

    DOWN = [
        882, 436,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 52,
        58, 160,
        58, 162,
        58, 162,
        58, 160,
        58, 162,
        58, 50,
        60, 160,
        58, 162,
        58, 160,
        58, 162,
        58, 52,
        58, 160,
        58, 52,
        58, 52,
        58, 50,
        60, 50,
        58, 52,
        58, 50,
        60, 160,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 3500,
        884, 434,
        60, 50,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 50,
        58, 162,
        58, 160,
        58, 162,
        58, 162,
        58, 160,
        58, 52,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 50,
        58, 160,
        60, 50,
        60, 50,
        58, 52,
        58, 50,
        58, 52,
        58, 52,
        58, 160,
        60, 50,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        58, 0
        ],

    UP = [
        882, 434,
        60, 50,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        62, 48,
        58, 162,
        58, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 52,
        58, 160,
        58, 162,
        58, 160,
        60, 160,
        60, 50,
        60, 50,
        58, 50,
        58, 52,
        58, 52,
        58, 50,
        60, 50,
        58, 52,
        58, 160,
        60, 160,
        62, 158,
        60, 158,
        58, 162,
        60, 158,
        62, 158,
        58, 3502,
        882, 436,
        58, 50,
        60, 160,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 50,
        58, 162,
        58, 160,
        58, 162,
        58, 162,
        58, 160,
        58, 52,
        58, 162,
        58, 160,
        58, 162,
        58, 160,
        60, 50,
        58, 52,
        58, 50,
        60, 50,
        58, 52,
        58, 52,
        58, 50,
        60, 50,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        60, 160,
        58, 162,
        58, 160,
        58, 0],
    )

if __name__ == "__main__":
    WriteCommandTimeseries()
